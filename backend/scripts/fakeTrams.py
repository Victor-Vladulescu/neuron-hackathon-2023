import time
import requests
from datetime import datetime

vehicles = [
    {
        "id": 1,
        "points": [
            [46.20294180872527, 21.291837955730493],
            [46.20108928864481, 21.29184423442201],
            [46.19899995782462, 21.29557623786498],
            [46.19450346678187, 21.30217874090604],
            [46.19200697658287, 21.308818416123195],
            [46.19015861033144, 21.318389523551907],
            [46.188747896375354, 21.32456013180231],
            [46.18552931052354, 21.324961214421485],
            [46.18243807726939, 21.324665000302126],
            [46.18104752781849, 21.333739939100973],
            [46.180043157593246, 21.345177189486535],
            [46.179125406519674, 21.349093545911305],
            [46.17755750954487, 21.356042915047897],
            [46.1767128726008, 21.35988626412131],
            [46.175574647687, 21.36002174053869],
            [46.17123647583111, 21.35807949880467],
            [46.17235871284787, 21.350393725908354],
            [46.17315426156302, 21.34838915959606],
            [46.17667172682452, 21.345907711758613],
            [46.17916608997228, 21.34072668607986],
            [46.18111006480524, 21.33374952924429],
            [46.18352254745423, 21.324157100755244],
            [46.185599887199324, 21.325080177455416],
            [46.1888859637744, 21.32451160783498],
            [46.189979677459895, 21.319519770468155],
            [46.19265092372615, 21.3068731856533],
            [46.19519595812834, 21.30076335919537],
            [46.1997013883308, 21.294470909878125]
        ]
    },
    {
        "id": 2,
        "points": [
            [46.175574647687, 21.36002174053869],
            [46.17123647583111, 21.35807949880467],
            [46.17235871284787, 21.350393725908354]
        ]
    }
]

def main():
    index = 0

    while True:
        time.sleep(1)

        for v in vehicles:
            payload = {'latitude': v['points'][index % len(v['points'])][0], 'longitude': v['points'][index % len(v['points'])][1], 'timestamp': datetime.now().strftime("%Y-%m-%dT%H:%M:%S.%fZ")}

            requests.put("http://uav-easy-exams.xyz:5000/api/vehicle/" + str(v['id']) + "/update", json=payload, 
                        headers={'Content-Type': 'application/json', 'Accept': 'application/json'})

        index += 1

if __name__ == "__main__":
    main()

# iterate over points
# send request once a second, with current time as timestamp