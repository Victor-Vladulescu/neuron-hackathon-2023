import time
import requests
from datetime import datetime

vehicles = [
    {
        "id": 1,
        "points": [
            [46.20294180872527, 21.291837955730493],
            [46.20108928864481, 21.29184423442201],
            [46.19899995782462, 21.29557623786498],
            [46.19450346678187, 21.30217874090604],
            [46.19200697658287, 21.308818416123195],
            [46.19015861033144, 21.318389523551907],
            [46.188747896375354, 21.32456013180231],
            [46.18552931052354, 21.324961214421485],
            [46.18243807726939, 21.324665000302126],
            [46.18104752781849, 21.333739939100973],
            [46.180043157593246, 21.345177189486535],
            [46.179125406519674, 21.349093545911305],
            [46.17755750954487, 21.356042915047897],
            [46.1767128726008, 21.35988626412131],
            [46.175574647687, 21.36002174053869],
            [46.17123647583111, 21.35807949880467],
            [46.17235871284787, 21.350393725908354],
            [46.17315426156302, 21.34838915959606],
            [46.17667172682452, 21.345907711758613],
            [46.17916608997228, 21.34072668607986],
            [46.18111006480524, 21.33374952924429],
            [46.18352254745423, 21.324157100755244],
            [46.185599887199324, 21.325080177455416],
            [46.1888859637744, 21.32451160783498],
            [46.189979677459895, 21.319519770468155],
            [46.19265092372615, 21.3068731856533],
            [46.19519595812834, 21.30076335919537],
            [46.1997013883308, 21.294470909878125]
        ]
    },
    {
        "id": 2,
        "points": [
            [46.172467702879345, 21.348067570614774],
            [46.171441298201586, 21.354296500690022],
            [46.171185842361574, 21.358146674210573],
            [46.17567494872854, 21.360174682413447],
            [46.177633254575674, 21.35599444163024],
            [46.17937542098297, 21.34830222010653],
            [46.18017320509748, 21.344870647973938],
            [46.18113825760529, 21.333602495495377],
            [46.18238222365074, 21.323011205340205],
            [46.178749145718015, 21.320090272796456],
            [46.1750721799391, 21.31776059951722],
            [46.17229407596919, 21.315953919423517],
            [46.1750721799391, 21.31776059951722],
            [46.178749145718015, 21.320090272796456],
            [46.18346204661266, 21.324127136474033],
            [46.18561512896215, 21.325080673226985],
            [46.18887290696443, 21.324515753747708],
            [46.190002660278424, 21.31939688650566],
            [46.19264473509468, 21.306887858506983]
        ]
    },
    {
        "id": 4,
        "points": [
            [46.16178650260994, 21.289879311411323],
            [46.179018720471674, 21.29424909631638],
            [46.18910336715999, 21.269851130658996],
            [46.203302773930716, 21.27203602310896],
            [46.21111508384497, 21.295584308397707],
            [46.21674261837545, 21.319618125347343],
            [46.21002310735994, 21.347778961369148],
            [46.19448108882054, 21.36040278435482],
            [46.18053153535943, 21.36877820541303],
            [46.16254315242674, 21.37266245865023],
            [46.151612757575045, 21.33491237243135],
            [46.15817125500898, 21.291214523472902]
        ]
    }

]

def main():
    index = 0

    while True:
        time.sleep(2.5)

        for v in vehicles:
            payload = {'latitude': v['points'][index % len(v['points'])][0], 'longitude': v['points'][index % len(v['points'])][1], 'timestamp': datetime.now().strftime("%Y-%m-%dT%H:%M:%S.%fZ")}

            requests.put("https://uav-easy-exams.xyz/api/vehicle/" + str(v['id']) + "/update", json=payload, 
                        headers={'Content-Type': 'application/json', 'Accept': 'application/json'})

        index += 1

if __name__ == "__main__":
    main()

# iterate over points
# send request once a second, with current time as timestamp